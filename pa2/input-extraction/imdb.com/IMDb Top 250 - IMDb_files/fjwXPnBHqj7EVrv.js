!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";a(3),a(2)},{2:2,3:3}],2:[function(a,b,c){"use strict";!function(a){a(document).on("seen-updated",".seen-widget",function(b){var c=a(this).data("collectionid");a(".seen-sidebar[data-collectionid="+c+"]").trigger("update")}).on("seen-init",".seen-widget",function(b){var c=a(this).data("collectionid"),d=a(".seen-sidebar[data-collectionid="+c+"]");a("input:checkbox",d).prop("checked",!1),d.trigger("update").removeClass("pending")}).on("update",".seen-sidebar",function(b){var c=a(this),d=c.data("collectionid"),e=a(".seen-collection[data-collectionid="+d+"] .seen-widget"),f=e.length,g=e.filter(".seen").length;a(".seen-count",c).text(g),a(".seen-size",c).text(f),a(".seen-pct",c).text("("+Math.floor(100*g/f)+"%)")})}(jQuery)},{}],3:[function(a,b,c){"use strict";!function(a){a(document).on("click",".seen-widget .inline",function(b){var c=a(this).closest(".seen-widget"),d=a("#seen-config");return void 0==d.data("userid")?void c.trigger("seen-not-logged-in"):c.hasClass("pending")||c.hasClass("unseeable")?!1:(a(".seen-widget .boundary").not(a(".boundary",c)).hide().removeClass("stick"),c.hasClass("seen")?void a(".boundary",c).toggle().removeClass("stick"):void c.trigger("ajax",{action:"see",callback:function(){a(".boundary",c).show().addClass("stick"),setTimeout(function(){a(".boundary",c).removeClass("stick"),a(".boundary",c).hasClass("left")&&a(".boundary",c).fadeOut().removeClass("left")},2e3)}}))}).on("click",".seen-widget .popover li",function(b){var c=a(this).closest(".seen-widget");c.trigger("ajax",{action:a(this).text()}),a(".boundary",c).hide().removeClass("stick")}).on("click",".seen-widget .popover .delete",function(b){var c=a(this).closest(".seen-widget");c.trigger("ajax",{action:0}),a(".boundary",c).hide().removeClass("stick")}).on("ajax",".seen-widget",function(b,c){var d=a(this),e=a(".seen-widget-"+d.data("titleid")).addClass("pending"),f=a("#seen-config"),g=c.action,h={caller:f.data("caller"),appToken:f.data("apptoken"),titleId:d.data("titleid"),action:g,pageType:f.data("pagetype"),subpageType:f.data("subpagetype"),baseRef:f.data("baseref")},i=d.closest(".seen-collection"),j=i.data("collectionid");if(void 0!=j){var k={},l={};a(".seen-widget",i).each(function(b,c){var d=a(c).data("titleid");k[d]++,a(c).hasClass("seen")&&l[d]++}),h.collectionId=i.data("collectionid"),h.collectionSize=Object.keys(k).length,h.seenCount=Object.keys(l).length,"see"==g?h.seenCount++:"0"==g&&h.seenCount--}a.ajax({url:"/seen/_ajax/seen",dataType:"json",type:"POST",data:h,error:function(){var b=a('<div class="error">Error</div>');a(".inline",e).prepend(b),b.show().delay(1e3).fadeOut("long",function(){e.removeClass("pending")})},success:function(){a(".popover li",e).removeClass("on"),"see"==g?e.addClass("seen").data("rating",null):"0"==g?e.removeClass("seen rated").data("rating",null):(e.addClass("seen rated").data("rating",g).each(function(b,c){a(".popover li",c).eq(g-1).prevAll().addBack().addClass("on")}),a(".inline .rating",e).text(g)),e.removeClass("pending"),null!=c.callback&&c.callback(),d.trigger("seen-updated")}}),a(".boundary",d).hide().removeClass("stick")}).on("mouseover",".seen-widget .popover li",function(b){var c=a(this).closest(".seen-widget"),d=a(".seen-widget-"+c.data("titleid"));a(".popover li",d).removeClass("on");var e=a(this).text();d.each(function(b,c){a(".popover li",c).eq(e-1).prevAll().addBack().addClass("on")}),d.addClass("rate-hover"),a(".inline .rating",d).text(e)}).on("mouseleave",".seen-widget .popover ol",function(b){var c=a(this).closest(".seen-widget"),d=a(".seen-widget-"+c.data("titleid"));a("li",d).removeClass("on");var e=c.data("rating");e>0&&d.each(function(b,c){a(".popover li",c).eq(e-1).prevAll().addBack().addClass("on")}),d.removeClass("rate-hover"),a(".inline .rating",d).text(e)}).on("mouseover",".seen-widget .popover .delete",function(b){var c=a(this).closest(".seen-widget"),d=a(".seen-widget-"+c.data("titleid"));d.addClass("delete-hover")}).on("mouseleave",".seen-widget .popover .delete",function(b){var c=a(this).closest(".seen-widget"),d=a(".seen-widget-"+c.data("titleid"));d.removeClass("delete-hover")}).on("mouseover",".seen-widget .boundary",function(){a(this).removeClass("left")}).on("mouseleave",".seen-widget .boundary",function(){var b=a(this).addClass("left");b.hasClass("stick")||b.fadeOut()})}(jQuery),$(function(){var a=$("#seen-config"),b=$(".seen-errors"),c={};if($(".seen-widget").each(function(a,b){var d=$(b);c[d.data("titleid")]=1;var e=d.closest(".seen-collection");e.length>0&&d.data("collectionid",e.data("collectionid"))}),void 0==a.data("userid"))return void $(".seen-widget").removeClass("pending").eq(0).trigger("seen-init");var d=$.map(c,function(a,b){return b});0!=d.length&&$.ajax({url:"/seen/_ajax/seen",dataType:"json",type:"POST",data:{caller:a.data("caller"),appToken:a.data("apptoken"),action:"fetch",titleIds:d},error:function(){b.length>0?b.show():alert("There was a problem loading your 'seen' titles; please reload or try later."),$(".seen-widget").hide()},success:function(a){$.each(d,function(b,c){var d,e,f=$(".seen-widget-"+c),g=a.titleIds[c];"seen"==g?d="seen":"X"==g?d="unseeable":g>=1&&10>=g&&(d="seen rated",e=g),f.addClass(d),void 0!=e&&(f.data("rating",e).each(function(a,b){$(".popover li",b).eq(e-1).prevAll().addBack().addClass("on")}),$(".inline .rating",f).text(e))}),$(".seen-widget").removeClass("pending").eq(0).trigger("seen-init")}})})},{}]},{},[1]);